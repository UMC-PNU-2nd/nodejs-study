# PNU UMC Server Study 6주차
## 강의밖에 없음
### Method
HTTP 통신 url 별로 method를 둘 수 있다.   
종류는 GET, POST, PUT, PATCH, DELETE가 있지만   
몇몇개에 대해 추가적으로 알 필요가 있다.

GET과 POST는 가장 많이 쓰인다. (내 경험으로는)    
GET은 db의 자원을 받고 싶을 때 사용하며    
POST는 그 db에 새로운 data를 만들어 놓고 싶을 때 사용한다.

GET은 parameter을 url param 또는 query param을 통해 전달할 수 있다.   
url param은
```
    /detail/<int:product_id> /detail/1
```
이렇게 product_id의 1번의 data를 get하고 싶다고 말하거나,   

또는 query param을 통해
```
    /detail?produect_id=1
```
처럼 ? 뒤에 parameter을 넣을 수 있다.

다만 GET은 url에 내가 검색한 정보가 있으니 털리기 쉽다.    
그러므로 털려도 되는 parameter만 넣자.    

보안성을 위해 POST를 사용할 수 있다.    
POST는 GET과 다르게 body를 통해 전달이 가능하다.   
url로 보이지 않기 때문에 보안성이 좋다.    
login에서 id-pw 쌍을 body에 넣어 로그인을 구현하거나    
또는 원래의 의도대로 data를 추가하기 위해 쓸 수도 있다.

DELETE는 data 삭제를 위한 method 지만,    
전 스터디에서 delete를 사용하지 않고 status만 바꾼다고 했었다.    
data가 일정 수 늘어나면 delete의 효율성이 바닥나기 때문에.    
그러므로 사용하지 않을거 같다.    

마지막으로 PUT과 PATCH인데,     
둘의 가장 큰 차이점은 PUT은 전체 교체, PATCH는 부분 교체이다.    
내 주관에 의하면 PATCH가 더 나아보인다.    
물론 실수가 없다는 가정하에 둘 다 사용할 수 있지만    
PUT을 사용하여 수정 할 경우, body에 바꾸지 않을 attribute의 내용도 넣지 않으면    
수정을 하지 않는게 아니가 빈칸으로 바꾸어 버린다.    
그러므로 수정 메소드는 PATCH로 통일하는 것이 좋아 보인다.

### API
API를 보고 가장 많이 든 생각이    
OOP에서 정보 은폐성과 비슷하다는 점이다.    
둘 다 내부의 동작이 어떻게 동작되어야 하는지 사용하는 입장에서 알 필요가 없다.    
그러므로 의도대로만 된다면, 어떻게든 만들 수 있는 flexibility를 확보할 수 있다.

### RESTful API
REST를 지켜 구현한 API를 RESTful API라고 한다.    
근데 대부분의 사람들이 입모아 말하는 얘기가 있다.    
규칙을 지켜야만 rest api라고 불릴 수 있는데,    
이 규칙을 너무 지키기 어렵다는 점.

REST api의 규칙은 아래와 같다.
* Client - Server 구조
  * 이원화 시켜서 서로 알 필요가 없게 한다.
* 무상태
  * 모든 요청이 특정 상태 값에 의존이 없어야 한다.
* Cache 가능
* 계층화
  * 중간에 다른 계층이 있어도, 클라이언트는 몰라도 된다.
* 일관된 인터페이스
  * 클라이언트 플랫폼과 무관하게 항상 동일한 인터페이스를 제공해야함.

보통 가장 지키기 어려운 규칙이 마지막의 "일관된 인터페이스" 라고 한다.    
이 일관성을 세부적으로 나눠지는 규칙이 더 존재하는데,    
여기서 Self-descriptive message와 HATEOAS가 특히 지키기 어렵다고 한다.

### Self-descriptive message
메세지가 담고 있는 정보에 대해 메세지 스스로 이해할 수 있는 정보를 포함해야 한다.    
단지 body의 내용을 보고 어떤 목적인지 유추할 수 있어야 한다는 것 같다.    
이를 해결하기 위해서 Content-type을 더 보완하거나,    
헤더의 Link에 profile relation을 추가하는 방법이 있다.

### HATEOAS
대부분 이걸 지키지 못한다고 들었다.   
서버가 클라이언트에게 하이퍼 미디어를 통해 정보를 동적으로 제공해야 한다.    

예를 들어 어떤 게시문을 열었을 때, 그 상황에서 추가적으로 할 수 있는 행동은 다음과 같다. (그 게시물의 주인일 때)
* 수정
* 삭제
* 댓글 달기(자댓)
* 추천(자추)

등등 있다. 이 때 이 게시물의 접근 응답에 위의 행동에 대한 하이퍼링크를 제공해서     
그 하이퍼 링크를 통해 클라이언트가 상태 전이를 할 수 있게 도와줘야 된다는 것이다.    
이 또한 헤더 Link에 href를 통해 넣을 수 있다.    

### 꼭 RESTful 이어야 하는가?
대부분이 이를 알고 있고, 대부분이 안지킨다.    
왜냐면 굳이 self-descriptive나 HATEOAS를 지켜    
RESTful을 확보하는 것은 뭐 보기에는 좋겠지만,    
이를 지켜서 얻을 수 있는 이점이 사용하는 시간에 비해 쓸모 없어 보이기 때문이다.    
가성비가 좋지 않다는 뜻.    

그러므로 개발자들이 지켜야 할 것은
* 정말 다 지키거나
* 또는 "내가 만든 api는 RESTful임"라고 함부로 말하기 금지.